<html>
<head>
<script>
	function getQueryVariable(variable) {
	    var query = window.location.search.substring(1);
	    var vars = query.split('&');
	    for (var i = 0; i < vars.length; i++) {
	        var pair = vars[i].split('=');
	        if (decodeURIComponent(pair[0]) == variable) {
	            return decodeURIComponent(pair[1]);
	        }
	    }
	    console.log('Query variable %s not found', variable);
	}


	var l=Array();
	var s=Array();
	i=0;
	l[i++]="http://rx14.co.uk/ipfs";
	l[i++]="https://ipfs.io/ipfs";
	l[i++]="https://gateway.ipfs.io/ipfs";
	l[i++]="https://ipfs.infura.io/ipfs";
	l[i++]="https://xmine128.tk/ipfs";
	l[i++]="https://ipfs.jes.xxx/ipfs";
	l[i++]="https://siderus.io/ipfs";
	l[i++]="https://www.eternum.io/ipfs";
	l[i++]="https://hardbin.com/ipfs";
	l[i++]="https://ipfs.macholibre.org/ipfs";
	l[i++]="https://ipfs.works/ipfs";
	l[i++]="https://ipfs.work/ipfs";
	l[i++]="https://ipfs.wa.hle.rs/ipfs";
	l[i++]="https://upload.global/ipfs";
	l[i++]="https://api.wisdom.sh/ipfs";
	l[i++]="https://h.ipfs.io/ipfs";
	l[i++]="http://h.groundupworks.com/ipfs";
	
	l[i++]="http://127.0.0.1:8080/ipfs";
	l[i++]="ipfs:/";

	function Test(url,index) {
		s[index]=performance.now();
	  	var xhttp = new XMLHttpRequest();
	 xhttp.onreadystatechange = function() {
		if (this.readyState == 4 && this.status == 200) {
			TestComplete(url,index,this.responseText);
		}
	};

	xhttp.open("GET", url + "/Qmaisz6NMhDB51cCvNWa1GMS7LU1pAxdF4Ld6Ft9kZEP2a", true);
	xhttp.send();
}
function TestComplete(url,index,what) {

	var isvalid=0;
	if ( what == "Hello from IPFS Gateway Checker\n" ) { 
		var speed= performance.now() - s[index];
		tmp.innerHTML=tmp.innerHTML + ("<a href='stream.html?gw=" + url + "'>" + url + "</a> ( " + speed  + " ms)<br>");
	}
}



</script>

</head>
<body>

<div id="gateway">
<h1>Stream following playlist</h1>

<h1>Select a GW to use</h1>
</div>

<script>

var tmp=document.getElementById("gateway");
for (var a=0; a < i; a++) {
Test(l[a],a);
}

</script>
</body>
</html>
